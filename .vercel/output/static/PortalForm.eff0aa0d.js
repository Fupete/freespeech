import{S as fe,i as de,s as pe,k,l as N,n as C,o as P,p as I,q as j,d as p,r as T,u as c,a as L,v as u,x as W,N as F,C as ee,z as ce,P as R}from"./chunks/index.e1c8ffd7.js";var me=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function he(t){return t.length>320?!1:me.test(t)}var be=he;function ne(t){let e,a;return{c(){e=k("p"),a=N("Email is already taken"),this.h()},l(s){e=P(s,"P",{class:!0});var l=I(e);a=j(l,"Email is already taken"),l.forEach(p),this.h()},h(){c(e,"class","mb-2 text-sm text-red-400")},m(s,l){L(s,e,l),u(e,a)},d(s){s&&p(e)}}}function oe(t){let e,a;return{c(){e=k("p"),a=N("Invalid email"),this.h()},l(s){e=P(s,"P",{class:!0});var l=I(e);a=j(l,"Invalid email"),l.forEach(p),this.h()},h(){c(e,"class","mb-2 text-sm text-red-400")},m(s,l){L(s,e,l),u(e,a)},d(s){s&&p(e)}}}function ie(t){let e,a,s,l;return{c(){e=k("p"),a=N("Add your name"),s=C(),l=k("input"),this.h()},l(i){e=P(i,"P",{});var o=I(e);a=j(o,"Add your name"),o.forEach(p),s=T(i),l=P(i,"INPUT",{class:!0,type:!0}),this.h()},h(){c(l,"class","mb-4 rounded-sm border border-gray-300 bg-gray-200 p-2 text-gray-500"),c(l,"type","text")},m(i,o){L(i,e,o),u(e,a),L(i,s,o),L(i,l,o),t[12](l)},p:ee,d(i){i&&p(e),i&&p(s),i&&p(l),t[12](null)}}}function ue(t){let e,a,s,l,i,o,g,h,y,E,A;return{c(){e=k("p"),a=N("Min 6 characters"),l=C(),i=k("p"),o=N("Confirm your password"),g=C(),h=k("input"),this.h()},l(n){e=P(n,"P",{class:!0});var m=I(e);a=j(m,"Min 6 characters"),m.forEach(p),l=T(n),i=P(n,"P",{});var Z=I(i);o=j(Z,"Confirm your password"),Z.forEach(p),g=T(n),h=P(n,"INPUT",{class:!0,type:!0}),this.h()},h(){c(e,"class",s=`mb-4 text-sm ${t[7]?"text-red-400":"text-gray-400"}`),c(h,"class",y=`rounded-sm border ${t[7]||t[8]?"border-red-400":"border-gray-300"}  bg-gray-200 p-2 text-gray-500`),c(h,"type","password")},m(n,m){L(n,e,m),u(e,a),L(n,l,m),L(n,i,m),u(i,o),L(n,g,m),L(n,h,m),t[15](h),E||(A=W(h,"change",t[16]),E=!0)},p(n,m){m&128&&s!==(s=`mb-4 text-sm ${n[7]?"text-red-400":"text-gray-400"}`)&&c(e,"class",s),m&384&&y!==(y=`rounded-sm border ${n[7]||n[8]?"border-red-400":"border-gray-300"}  bg-gray-200 p-2 text-gray-500`)&&c(h,"class",y)},d(n){n&&p(e),n&&p(l),n&&p(i),n&&p(g),n&&p(h),t[15](null),E=!1,A()}}}function _e(t){let e,a,s=t[0]?"Your email":"Add your email",l,i,o,g,h,y,E,A,n,m=t[0]?"Your password":"Choose a password",Z,M,S,D,q,Y,d,z=t[0]?"Log in":"Create account",V,X,U,J=t[0]?"Don't have an account?":"Already have an account?",G,x,O,B=t[0]?"Create one instead":"Log in instead",H,K,$,te,v=t[5]&&ne(),w=t[6]&&oe(),b=!t[0]&&ie(t),_=!t[0]&&ue(t);return{c(){e=k("div"),a=k("p"),l=N(s),i=C(),o=k("input"),h=C(),v&&v.c(),y=C(),w&&w.c(),E=C(),b&&b.c(),A=C(),n=k("p"),Z=N(m),M=C(),S=k("input"),q=C(),_&&_.c(),Y=C(),d=k("button"),V=N(z),X=C(),U=k("p"),G=N(J),x=C(),O=k("a"),H=N(B),this.h()},l(f){e=P(f,"DIV",{class:!0});var r=I(e);a=P(r,"P",{});var ae=I(a);l=j(ae,s),ae.forEach(p),i=T(r),o=P(r,"INPUT",{class:!0,type:!0}),h=T(r),v&&v.l(r),y=T(r),w&&w.l(r),E=T(r),b&&b.l(r),A=T(r),n=P(r,"P",{});var le=I(n);Z=j(le,m),le.forEach(p),M=T(r),S=P(r,"INPUT",{class:!0,type:!0}),q=T(r),_&&_.l(r),Y=T(r),d=P(r,"BUTTON",{class:!0});var se=I(d);V=j(se,z),se.forEach(p),X=T(r),U=P(r,"P",{});var Q=I(U);G=j(Q,J),x=T(Q),O=P(Q,"A",{class:!0,href:!0});var re=I(O);H=j(re,B),re.forEach(p),Q.forEach(p),r.forEach(p),this.h()},h(){c(o,"class",g=`${t[5]||t[6]?"":"mb-4"} rounded-sm border ${t[5]||t[6]?"border-red-400":"border-gray-300"} bg-gray-200 p-2 text-gray-500`),c(o,"type","text"),c(S,"class",D=`rounded-sm border ${t[7]||t[8]?"border-red-400":"border-gray-300"}  bg-gray-200 p-2 text-gray-500`),c(S,"type","password"),c(d,"class","my-4 flex justify-center rounded-md border border-blue-400 bg-blue-600 p-2 text-blue-50"),c(O,"class","text-sm text-blue-500 underline"),c(O,"href",K=t[0]?"/portal/signup":"/portal/login"),c(e,"class","flex w-full flex-col")},m(f,r){L(f,e,r),u(e,a),u(a,l),u(e,i),u(e,o),t[11](o),u(e,h),v&&v.m(e,null),u(e,y),w&&w.m(e,null),u(e,E),b&&b.m(e,null),u(e,A),u(e,n),u(n,Z),u(e,M),u(e,S),t[13](S),u(e,q),_&&_.m(e,null),u(e,Y),u(e,d),u(d,V),u(e,X),u(e,U),u(U,G),u(U,x),u(U,O),u(O,H),$||(te=[W(o,"change",t[10]),W(S,"change",t[14]),W(d,"click",t[9])],$=!0)},p(f,[r]){r&1&&s!==(s=f[0]?"Your email":"Add your email")&&F(l,s),r&96&&g!==(g=`${f[5]||f[6]?"":"mb-4"} rounded-sm border ${f[5]||f[6]?"border-red-400":"border-gray-300"} bg-gray-200 p-2 text-gray-500`)&&c(o,"class",g),f[5]?v||(v=ne(),v.c(),v.m(e,y)):v&&(v.d(1),v=null),f[6]?w||(w=oe(),w.c(),w.m(e,E)):w&&(w.d(1),w=null),f[0]?b&&(b.d(1),b=null):b?b.p(f,r):(b=ie(f),b.c(),b.m(e,A)),r&1&&m!==(m=f[0]?"Your password":"Choose a password")&&F(Z,m),r&384&&D!==(D=`rounded-sm border ${f[7]||f[8]?"border-red-400":"border-gray-300"}  bg-gray-200 p-2 text-gray-500`)&&c(S,"class",D),f[0]?_&&(_.d(1),_=null):_?_.p(f,r):(_=ue(f),_.c(),_.m(e,Y)),r&1&&z!==(z=f[0]?"Log in":"Create account")&&F(V,z),r&1&&J!==(J=f[0]?"Don't have an account?":"Already have an account?")&&F(G,J),r&1&&B!==(B=f[0]?"Create one instead":"Log in instead")&&F(H,B),r&1&&K!==(K=f[0]?"/portal/signup":"/portal/login")&&c(O,"href",K)},i:ee,o:ee,d(f){f&&p(e),t[11](null),v&&v.d(),w&&w.d(),b&&b.d(),t[13](null),_&&_.d(),$=!1,ce(te)}}}function ge(t,e,a){let{isLogin:s}=e,l,i,o,g,h=!1,y=!1,E=!1,A=!1;const n=async()=>{if(h||y||E||A){alert("Please fix the errors before submitting");return}if(l.value.length===0||o.value.length===0){alert("Please fill out all fields");return}const z=await(await fetch(`/api/v1/user/${s?"login":"create"}.json`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.value,password:o.value,name:i?.value||"",userAgent:window.navigator.userAgent})})).json();z.success===!1?alert("Something went wrong, please check your credentials and try again"):(document.cookie=`token=${z.token.token}; path=/; max-age=31536000; SameSite=Lax`,window.location.assign("/dashboard"))},m=async()=>{if(be(l.value)?a(6,y=!1):a(6,y=!0),y||s)return;const z=await(await fetch("/api/v1/user/checkEmail.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.value})})).json();a(5,h=z.taken)};function Z(d){R[d?"unshift":"push"](()=>{l=d,a(1,l)})}function M(d){R[d?"unshift":"push"](()=>{i=d,a(2,i)})}function S(d){R[d?"unshift":"push"](()=>{o=d,a(3,o)})}const D=()=>{s||(o.value.length>5?a(7,E=!1):a(7,E=!0),o.value===g.value?a(8,A=!1):a(8,A=!0))};function q(d){R[d?"unshift":"push"](()=>{g=d,a(4,g)})}const Y=()=>{o.value===g.value?a(8,A=!1):a(8,A=!0)};return t.$$set=d=>{"isLogin"in d&&a(0,s=d.isLogin)},[s,l,i,o,g,h,y,E,A,n,m,Z,M,S,D,q,Y]}class ve extends fe{constructor(e){super(),de(this,e,ge,_e,pe,{isLogin:0})}}export{ve as default};
